using System;
using System.Collections.Generic;
using System.Windows.Forms;

namespace FERExcelAddIn
{
    public partial class LWNForm : Form
    {
        private Dictionary<(string size, string schedule), double> thicknessData;

        public LWNForm()
        {
            InitializeComponent();
            InitializeThicknessData();
            InitializeComponentEvents();
        }

        private void InitializeThicknessData()
        {
            thicknessData = new Dictionary<(string size, string schedule), double>()
            {
                // 150#-LWN
                {("0.5", "150#-LWN"), 0.375}, {("0.75", "150#-LWN"), 0.435}, {("1", "150#-LWN"), 0.5},
                {("1.25", "150#-LWN"), 0.565}, {("1.5", "150#-LWN"), 0.56}, {("2", "150#-LWN"), 0.53},
                {("2.5", "150#-LWN"), 0.625}, {("3", "150#-LWN"), 0.625}, {("3.5", "150#-LWN"), 0.69},
                {("4", "150#-LWN"), 0.75}, {("5", "150#-LWN"), 0.75}, {("6", "150#-LWN"), 0.875},
                {("8", "150#-LWN"), 0.875}, {("10", "150#-LWN"), 1.0}, {("12", "150#-LWN"), 1.19},
                {("14", "150#-LWN"), 1.0}, {("16", "150#-LWN"), 1.0}, {("18", "150#-LWN"), 1.0},
                {("20", "150#-LWN"), 1.0}, {("24", "150#-LWN"), 1.125},

                // 300#-LWN
                {("0.5", "300#-LWN"), 0.5}, {("0.75", "300#-LWN"), 0.565}, {("1", "300#-LWN"), 0.56},
                {("1.25", "300#-LWN"), 0.625}, {("1.5", "300#-LWN"), 0.625}, {("2", "300#-LWN"), 0.655},
                {("2.5", "300#-LWN"), 0.72}, {("3", "300#-LWN"), 0.81}, {("3.5", "300#-LWN"), 0.875},
                {("4", "300#-LWN"), 0.875}, {("5", "300#-LWN"), 1.0}, {("6", "300#-LWN"), 1.06},
                {("8", "300#-LWN"), 1.125}, {("10", "300#-LWN"), 1.31}, {("12", "300#-LWN"), 1.375},
                {("14", "300#-LWN"), 1.375}, {("16", "300#-LWN"), 1.5}, {("18", "300#-LWN"), 1.5},
                {("20", "300#-LWN"), 1.56}, {("24", "300#-LWN"), 1.81},

                // 400#-LWN
                {("0.5", "400#-LWN"), 0.5}, {("0.75", "400#-LWN"), 0.565}, {("1", "400#-LWN"), 0.56},
                {("1.25", "400#-LWN"), 0.625}, {("1.5", "400#-LWN"), 0.625}, {("2", "400#-LWN"), 0.655},
                {("2.5", "400#-LWN"), 0.72}, {("3", "400#-LWN"), 0.81}, {("3.5", "400#-LWN"), 0.875},
                {("4", "400#-LWN"), 0.875}, {("5", "400#-LWN"), 1.0}, {("6", "400#-LWN"), 1.06},
                {("8", "400#-LWN"), 1.125}, {("10", "400#-LWN"), 1.31}, {("12", "400#-LWN"), 1.375},
                {("14", "400#-LWN"), 1.375}, {("16", "400#-LWN"), 1.5}, {("18", "400#-LWN"), 1.5},
                {("20", "400#-LWN"), 1.56}, {("24", "400#-LWN"), 1.81},

                // 600#-LWN
                {("0.5", "600#-LWN"), 0.5}, {("0.75", "600#-LWN"), 0.565}, {("1", "600#-LWN"), 0.56},
                {("1.25", "600#-LWN"), 0.625}, {("1.5", "600#-LWN"), 0.625}, {("2", "600#-LWN"), 0.655},
                {("2.5", "600#-LWN"), 0.72}, {("3", "600#-LWN"), 0.81}, {("3.5", "600#-LWN"), 0.875},
                {("4", "600#-LWN"), 0.875}, {("5", "600#-LWN"), 1.0}, {("6", "600#-LWN"), 1.06},
                {("8", "600#-LWN"), 1.125}, {("10", "600#-LWN"), 1.31}, {("12", "600#-LWN"), 1.375},
                {("14", "600#-LWN"), 1.375}, {("16", "600#-LWN"), 1.5}, {("18", "600#-LWN"), 1.5},
                {("20", "600#-LWN"), 1.56}, {("24", "600#-LWN"), 1.81},

                // 900#-LWN
                {("0.5", "900#-LWN"), 0.5}, {("0.75", "900#-LWN"), 0.565}, {("1", "900#-LWN"), 0.56},
                {("1.25", "900#-LWN"), 0.625}, {("1.5", "900#-LWN"), 0.625}, {("2", "900#-LWN"), 0.655},
                {("2.5", "900#-LWN"), 0.72}, {("3", "900#-LWN"), 0.81}, {("3.5", "900#-LWN"), 0.875},
                {("4", "900#-LWN"), 0.875}, {("5", "900#-LWN"), 1.0}, {("6", "900#-LWN"), 1.06},
                {("8", "900#-LWN"), 1.125}, {("10", "900#-LWN"), 1.31}, {("12", "900#-LWN"), 1.375},
                {("14", "900#-LWN"), 1.375}, {("16", "900#-LWN"), 1.5}, {("18", "900#-LWN"), 1.5},
                {("20", "900#-LWN"), 1.56}, {("24", "900#-LWN"), 1.81},

                // 1500#-LWN
                {("0.5", "1500#-LWN"), 0.5}, {("0.75", "1500#-LWN"), 0.565}, {("1", "1500#-LWN"), 0.56},
                {("1.25", "1500#-LWN"), 0.625}, {("1.5", "1500#-LWN"), 0.625}, {("2", "1500#-LWN"), 0.655},
                {("2.5", "1500#-LWN"), 0.72}, {("3", "1500#-LWN"), 0.81}, {("3.5", "1500#-LWN"), 0.875},
                {("4", "1500#-LWN"), 0.875}, {("5", "1500#-LWN"), 1.0}, {("6", "1500#-LWN"), 1.06},
                {("8", "1500#-LWN"), 1.125}, {("10", "1500#-LWN"), 1.31}, {("12", "1500#-LWN"), 1.375},
                {("14", "1500#-LWN"), 1.375}, {("16", "1500#-LWN"), 1.5}, {("18", "1500#-LWN"), 1.5},
                {("20", "1500#-LWN"), 1.56}, {("24", "1500#-LWN"), 1.81},

                // 2500#-LWN
                {("0.5", "2500#-LWN"), 0.5}, {("0.75", "2500#-LWN"), 0.565}, {("1", "2500#-LWN"), 0.56},
                {("1.25", "2500#-LWN"), 0.625}, {("1.5", "2500#-LWN"), 0.625}, {("2", "2500#-LWN"), 0.655},
                {("2.5", "2500#-LWN"), 0.72}, {("3", "2500#-LWN"), 0.81}, {("3.5", "2500#-LWN"), 0.875},
                {("4", "2500#-LWN"), 0.875}, {("5", "2500#-LWN"), 1.0}, {("6", "2500#-LWN"), 1.06},
                {("8", "2500#-LWN"), 1.125}, {("10", "2500#-LWN"), 1.31}, {("12", "2500#-LWN"), 1.375},
                {("14", "2500#-LWN"), 1.375}, {("16", "2500#-LWN"), 1.5}, {("18", "2500#-LWN"), 1.5},
                {("20", "2500#-LWN"), 1.56}, {("24", "2500#-LWN"), 1.81},

                // 150#-HB
                {("0.5", "150#-HB"), 0.375}, {("0.75", "150#-HB"), 0.435}, {("1", "150#-HB"), 0.5},
                {("1.25", "150#-HB"), 0.565}, {("1.5", "150#-HB"), 0.56}, {("2", "150#-HB"), 0.53},
                {("2.5", "150#-HB"), 0.625}, {("3", "150#-HB"), 0.625}, {("3.5", "150#-HB"), 0.69},
                {("4", "150#-HB"), 0.75}, {("5", "150#-HB"), 0.75}, {("6", "150#-HB"), 0.875},
                {("8", "150#-HB"), 0.875}, {("10", "150#-HB"), 1.0}, {("12", "150#-HB"), 1.19},
                {("14", "150#-HB"), 1.0}, {("16", "150#-HB"), 1.0}, {("18", "150#-HB"), 1.0},
                {("20", "150#-HB"), 1.0}, {("24", "150#-HB"), 1.125},

                // 300#-HB
                {("0.5", "300#-HB"), 0.5}, {("0.75", "300#-HB"), 0.565}, {("1", "300#-HB"), 0.56},
                {("1.25", "300#-HB"), 0.625}, {("1.5", "300#-HB"), 0.625}, {("2", "300#-HB"), 0.655},
                {("2.5", "300#-HB"), 0.72}, {("3", "300#-HB"), 0.81}, {("3.5", "300#-HB"), 0.875},
                {("4", "300#-HB"), 0.875}, {("5", "300#-HB"), 1.0}, {("6", "300#-HB"), 1.06},
                {("8", "300#-HB"), 1.125}, {("10", "300#-HB"), 1.31}, {("12", "300#-HB"), 1.375},
                {("14", "300#-HB"), 1.375}, {("16", "300#-HB"), 1.5}, {("18", "300#-HB"), 1.5},
                {("20", "300#-HB"), 1.56}, {("24", "300#-HB"), 1.81},

                // 400#-HB
                {("0.5", "400#-HB"), 0.5}, {("0.75", "400#-HB"), 0.565}, {("1", "400#-HB"), 0.56},
                {("1.25", "400#-HB"), 0.625}, {("1.5", "400#-HB"), 0.625}, {("2", "400#-HB"), 0.655},
                {("2.5", "400#-HB"), 0.72}, {("3", "400#-HB"), 0.81}, {("3.5", "400#-HB"), 0.875},
                {("4", "400#-HB"), 0.875}, {("5", "400#-HB"), 1.0}, {("6", "400#-HB"), 1.06},
                {("8", "400#-HB"), 1.125}, {("10", "400#-HB"), 1.31}, {("12", "400#-HB"), 1.375},
                {("14", "400#-HB"), 1.375}, {("16", "400#-HB"), 1.5}, {("18", "400#-HB"), 1.5},
                {("20", "400#-HB"), 1.56}, {("24", "400#-HB"), 1.81},

                // 600#-HB
                {("0.5", "600#-HB"), 0.5}, {("0.75", "600#-HB"), 0.565}, {("1", "600#-HB"), 0.56},
                {("1.25", "600#-HB"), 0.625}, {("1.5", "600#-HB"), 0.625}, {("2", "600#-HB"), 0.655},
                {("2.5", "600#-HB"), 0.72}, {("3", "600#-HB"), 0.81}, {("3.5", "600#-HB"), 0.875},
                {("4", "600#-HB"), 0.875}, {("5", "600#-HB"), 1.0}, {("6", "600#-HB"), 1.06},
                {("8", "600#-HB"), 1.125}, {("10", "600#-HB"), 1.31}, {("12", "600#-HB"), 1.375},
                {("14", "600#-HB"), 1.375}, {("16", "600#-HB"), 1.5}, {("18", "600#-HB"), 1.5},
                {("20", "600#-HB"), 1.56}, {("24", "600#-HB"), 1.81},

                // 900#-HB
                {("0.5", "900#-HB"), 0.5}, {("0.75", "900#-HB"), 0.565}, {("1", "900#-HB"), 0.56},
                {("1.25", "900#-HB"), 0.625}, {("1.5", "900#-HB"), 0.625}, {("2", "900#-HB"), 0.655},
                {("2.5", "900#-HB"), 0.72}, {("3", "900#-HB"), 0.81}, {("3.5", "900#-HB"), 0.875},
                {("4", "900#-HB"), 0.875}, {("5", "900#-HB"), 1.0}, {("6", "900#-HB"), 1.06},
                {("8", "900#-HB"), 1.125}, {("10", "900#-HB"), 1.31}, {("12", "900#-HB"), 1.375},
                {("14", "900#-HB"), 1.375}, {("16", "900#-HB"), 1.5}, {("18", "900#-HB"), 1.5},
                {("20", "900#-HB"), 1.56}, {("24", "900#-HB"), 1.81},

                // 1500#-HB
                {("0.5", "1500#-HB"), 0.5}, {("0.75", "1500#-HB"), 0.565}, {("1", "1500#-HB"), 0.56},
                {("1.25", "1500#-HB"), 0.625}, {("1.5", "1500#-HB"), 0.625}, {("2", "1500#-HB"), 0.655},
                {("2.5", "1500#-HB"), 0.72}, {("3", "1500#-HB"), 0.81}, {("3.5", "1500#-HB"), 0.875},
                {("4", "1500#-HB"), 0.875}, {("5", "1500#-HB"), 1.0}, {("6", "1500#-HB"), 1.06},
                {("8", "1500#-HB"), 1.125}, {("10", "1500#-HB"), 1.31}, {("12", "1500#-HB"), 1.375},
                {("14", "1500#-HB"), 1.375}, {("16", "1500#-HB"), 1.5}, {("18", "1500#-HB"), 1.5},
                {("20", "1500#-HB"), 1.56}, {("24", "1500#-HB"), 1.81},

                // 2500#-HB
                {("0.5", "2500#-HB"), 0.5}, {("0.75", "2500#-HB"), 0.565}, {("1", "2500#-HB"), 0.56},
                {("1.25", "2500#-HB"), 0.625}, {("1.5", "2500#-HB"), 0.625}, {("2", "2500#-HB"), 0.655},
                {("2.5", "2500#-HB"), 0.72}, {("3", "2500#-HB"), 0.81}, {("3.5", "2500#-HB"), 0.875},
                {("4", "2500#-HB"), 0.875}, {("5", "2500#-HB"), 1.0}, {("6", "2500#-HB"), 1.06},
                {("8", "2500#-HB"), 1.125}, {("10", "2500#-HB"), 1.31}, {("12", "2500#-HB"), 1.375},
                {("14", "2500#-HB"), 1.375}, {("16", "2500#-HB"), 1.5}, {("18", "2500#-HB"), 1.5},
                {("20", "2500#-HB"), 1.56}, {("24", "2500#-HB"), 1.81},

                // 150#-EB
                {("0.5", "150#-EB"), 0.375}, {("0.75", "150#-EB"), 0.435}, {("1", "150#-EB"), 0.5},
                {("1.25", "150#-EB"), 0.565}, {("1.5", "150#-EB"), 0.56}, {("2", "150#-EB"), 0.53},
                {("2.5", "150#-EB"), 0.625}, {("3", "150#-EB"), 0.625}, {("3.5", "150#-EB"), 0.69},
                {("4", "150#-EB"), 0.75}, {("5", "150#-EB"), 0.75}, {("6", "150#-EB"), 0.875},
                {("8", "150#-EB"), 0.875}, {("10", "150#-EB"), 1.0}, {("12", "150#-EB"), 1.19},
                {("14", "150#-EB"), 1.0}, {("16", "150#-EB"), 1.0}, {("18", "150#-EB"), 1.0},
                {("20", "150#-EB"), 1.0}, {("24", "150#-EB"), 1.125},

                // 300#-EB
                {("0.5", "300#-EB"), 0.5}, {("0.75", "300#-EB"), 0.565}, {("1", "300#-EB"), 0.56},
                {("1.25", "300#-EB"), 0.625}, {("1.5", "300#-EB"), 0.625}, {("2", "300#-EB"), 0.655},
                {("2.5", "300#-EB"), 0.72}, {("3", "300#-EB"), 0.81}, {("3.5", "300#-EB"), 0.875},
                {("4", "300#-EB"), 0.875}, {("5", "300#-EB"), 1.0}, {("6", "300#-EB"), 1.06},
                {("8", "300#-EB"), 1.125}, {("10", "300#-EB"), 1.31}, {("12", "300#-EB"), 1.375},
                {("14", "300#-EB"), 1.375}, {("16", "300#-EB"), 1.5}, {("18", "300#-EB"), 1.5},
                {("20", "300#-EB"), 1.56}, {("24", "300#-EB"), 1.81},

                // 400#-EB
                {("0.5", "400#-EB"), 0.5}, {("0.75", "400#-EB"), 0.565}, {("1", "400#-EB"), 0.56},
                {("1.25", "400#-EB"), 0.625}, {("1.5", "400#-EB"), 0.625}, {("2", "400#-EB"), 0.655},
                {("2.5", "400#-EB"), 0.72}, {("3", "400#-EB"), 0.81}, {("3.5", "400#-EB"), 0.875},
                {("4", "400#-EB"), 0.875}, {("5", "400#-EB"), 1.0}, {("6", "400#-EB"), 1.06},
                {("8", "400#-EB"), 1.125}, {("10", "400#-EB"), 1.31}, {("12", "400#-EB"), 1.375},
                {("14", "400#-EB"), 1.375}, {("16", "400#-EB"), 1.5}, {("18", "400#-EB"), 1.5},
                {("20", "400#-EB"), 1.56}, {("24", "400#-EB"), 1.81},

                // 600#-EB
                {("0.5", "600#-EB"), 0.5}, {("0.75", "600#-EB"), 0.565}, {("1", "600#-EB"), 0.56},
                {("1.25", "600#-EB"), 0.625}, {("1.5", "600#-EB"), 0.625}, {("2", "600#-EB"), 0.655},
                {("2.5", "600#-EB"), 0.72}, {("3", "600#-EB"), 0.81}, {("3.5", "600#-EB"), 0.875},
                {("4", "600#-EB"), 0.875}, {("5", "600#-EB"), 1.0}, {("6", "600#-EB"), 1.06},
                {("8", "600#-EB"), 1.125}, {("10", "600#-EB"), 1.31}, {("12", "600#-EB"), 1.375},
                {("14", "600#-EB"), 1.375}, {("16", "600#-EB"), 1.5}, {("18", "600#-EB"), 1.5},
                {("20", "600#-EB"), 1.56}, {("24", "600#-EB"), 1.81},

                // 900#-EB
                {("0.5", "900#-EB"), 0.5}, {("0.75", "900#-EB"), 0.565}, {("1", "900#-EB"), 0.56},
                {("1.25", "900#-EB"), 0.625}, {("1.5", "900#-EB"), 0.625}, {("2", "900#-EB"), 0.655},
                {("2.5", "900#-EB"), 0.72}, {("3", "900#-EB"), 0.81}, {("3.5", "900#-EB"), 0.875},
                {("4", "900#-EB"), 0.875}, {("5", "900#-EB"), 1.0}, {("6", "900#-EB"), 1.06},
                {("8", "900#-EB"), 1.125}, {("10", "900#-EB"), 1.31}, {("12", "900#-EB"), 1.375},
                {("14", "900#-EB"), 1.375}, {("16", "900#-EB"), 1.5}, {("18", "900#-EB"), 1.5},
                {("20", "900#-EB"), 1.56}, {("24", "900#-EB"), 1.81},

                // 1500#-EB
                {("0.5", "1500#-EB"), 0.5}, {("0.75", "1500#-EB"), 0.565}, {("1", "1500#-EB"), 0.56},
                {("1.25", "1500#-EB"), 0.625}, {("1.5", "1500#-EB"), 0.625}, {("2", "1500#-EB"), 0.655},
                {("2.5", "1500#-EB"), 0.72}, {("3", "1500#-EB"), 0.81}, {("3.5", "1500#-EB"), 0.875},
                {("4", "1500#-EB"), 0.875}, {("5", "1500#-EB"), 1.0}, {("6", "1500#-EB"), 1.06},
                {("8", "1500#-EB"), 1.125}, {("10", "1500#-EB"), 1.31}, {("12", "1500#-EB"), 1.375},
                {("14", "1500#-EB"), 1.375}, {("16", "1500#-EB"), 1.5}, {("18", "1500#-EB"), 1.5},
                {("20", "1500#-EB"), 1.56}, {("24", "1500#-EB"), 1.81},

                // 2500#-EB
                {("0.5", "2500#-EB"), 0.5}, {("0.75", "2500#-EB"), 0.565}, {("1", "2500#-EB"), 0.56},
                {("1.25", "2500#-EB"), 0.625}, {("1.5", "2500#-EB"), 0.625}, {("2", "2500#-EB"), 0.655},
                {("2.5", "2500#-EB"), 0.72}, {("3", "2500#-EB"), 0.81}, {("3.5", "2500#-EB"), 0.875},
                {("4", "2500#-EB"), 0.875}, {("5", "2500#-EB"), 1.0}, {("6", "2500#-EB"), 1.06},
                {("8", "2500#-EB"), 1.125}, {("10", "2500#-EB"), 1.31}, {("12", "2500#-EB"), 1.375},
                {("14", "2500#-EB"), 1.375}, {("16", "2500#-EB"), 1.5}, {("18", "2500#-EB"), 1.5},
                {("20", "2500#-EB"), 1.56}, {("24", "2500#-EB"), 1.81}
    };
        }

        private void InitializeComponentEvents()
        {
            this.Load += LWNForm_Load;
            this.btnLWNLookupThickness.Click += BtnLWNLookupThickness_Click;
            this.btnClose.Click += BtnClose_Click;
        }

        private void LWNForm_Load(object sender, EventArgs e)
        {
            // Clear existing items first
            cmbLWNSize.Items.Clear();
            cmbLWNSchedule.Items.Clear();

            // Populate size combo box
            cmbLWNSize.Items.AddRange(new object[] {
                "0.5", "0.75", "1", "1.25", "1.5", "2", "2.5", "3", "3.5", "4",
                "5", "6", "8", "10", "12", "14", "16", "18", "20", "24"});

            // Populate schedule combo box
            cmbLWNSchedule.Items.AddRange(new object[] {
                "150#-LWN", "300#-LWN", "400#-LWN", "600#-LWN", "900#-LWN", "1500#-LWN", "2500#-LWN",
                "150#-HB", "300#-HB", "400#-HB", "600#-HB", "900#-HB", "1500#-HB", "2500#-HB",
                "150#-EB", "300#-EB", "400#-EB", "600#-EB", "900#-EB", "1500#-EB", "2500#-EB"});
        }

        private void BtnLWNLookupThickness_Click(object sender, EventArgs e)
        {
            try
            {
                if (cmbLWNSize.SelectedItem == null || cmbLWNSchedule.SelectedItem == null)
                {
                    MessageBox.Show("Please select both Size and Schedule", "Selection Required",
                                    MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    return;
                }

                string size = cmbLWNSize.SelectedItem.ToString();
                string schedule = cmbLWNSchedule.SelectedItem.ToString();

                // Set the ID text box with the selected size
                txtLWNID.Text = size;

                if (thicknessData.TryGetValue((size, schedule), out double thickness))
                {
                    txtLWNThickness.Text = thickness.ToString("0.###");

                    // Calculate limits (±12.5%)
                    double lowerLimit = Math.Round(thickness * 0.875, 3);
                    double upperLimit = Math.Round(thickness * 1.125, 3);
                    txtLWNLowerMil.Text = lowerLimit.ToString("0.###");
                    txtLWNUpperMil.Text = upperLimit.ToString("0.###");

                    // Calculate OD (OD = ID + (2 × Thickness))
                    if (double.TryParse(size, out double id))
                    {
                        double od = id + (2 * thickness);
                        txtLWNOD.Text = od.ToString("0.###");
                    }
                    else
                    {
                        txtLWNOD.Text = "N/A";
                    }
                }
                else
                {
                    MessageBox.Show($"Thickness data not found for {size}\" {schedule}", "Data Not Found",
                                    MessageBoxButtons.OK, MessageBoxIcon.Information);
                    ClearResults();
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"An error occurred: {ex.Message}", "Error",
                                MessageBoxButtons.OK, MessageBoxIcon.Error);
                ClearResults();
            }
        }

        private void BtnClose_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void ClearResults()
        {
            txtLWNThickness.Text = string.Empty;
            txtLWNLowerMil.Text = string.Empty;
            txtLWNUpperMil.Text = string.Empty;
            txtLWNID.Text = string.Empty;
            txtLWNOD.Text = string.Empty;
        }
    }
}